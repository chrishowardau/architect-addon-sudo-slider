/*!
 * jQuery BBQ: Back Button & Query Library - v1.3pre - 8/26/2010
 * http://benalman.com/projects/jquery-bbq-plugin/
 *
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(a){function q(b){return"string"===typeof b}function p(b){var a=r.call(arguments,1);return function(){return b.apply(this,a.concat(r.call(arguments)))}}function s(b,e,d,f,n){var D;f!==c?(e=d.match(b?B:/^([^#?]*)\??([^#]*)(#?.*)/),d=e[3]||"",2===n&&q(f)?f=f.replace(b?C:F,""):(D=g(e[2]),f=q(f)?g[b?v:y](f):f,f=2===n?f:1===n?a.extend({},f,D):a.extend({},D,f),f=t(f),b&&(f=f.replace(G,w))),b=e[1]+(b?E:f||!e[1]?"?":"")+f+d):b=e(d!==c?d:location.href);return b}function x(b,a,d){a===c||"boolean"===
typeof a?(d=a,a=h[b?v:y]()):a=q(a)?a.replace(b?C:F,""):a;return g(a,d)}function z(b,e,d,f){!q(d)&&"object"!==typeof d&&(f=d,d=e,e=c);return this.each(function(){var c=a(this),n=e||H()[(this.nodeName||"").toLowerCase()]||"",l=n&&c.attr(n)||"";c.attr(n,h[b](l,d,f))})}"$:nomunge";var c,r=Array.prototype.slice,w=decodeURIComponent,h=a.param,t,k,g,A,j=a.bbq=a.bbq||{},u,n,H,I=a.event.special,y="querystring",v="fragment",F=/^.*\?|#.*$/g,C,B,G,J,E,K={};h[y]=p(s,0,function(b){return b.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,
"$1")});h[v]=k=p(s,1,function(b){return b.replace(B,"$2")});h.sorted=t=function(b,e){var d=[],f={};a.each(h(b,e).split("&"),function(b,a){var e=a.replace(/(?:%5B|=).*$/,""),c=f[e];c||(c=f[e]=[],d.push(e));c.push(a)});return a.map(d.sort(),function(a){return f[a]}).join("&")};k.noEscape=function(b){b=a.map((b||"").split(""),encodeURIComponent);G=RegExp(b.join("|"),"g")};k.noEscape(",/");k.ajaxCrawlable=function(a){a!==c&&(a?(C=/^.*(?:#!|#)/,B=/^([^#]*)(?:#!|#)?(.*)$/,E="#!"):(C=/^.*#/,B=/^([^#]*)#?(.*)$/,
E="#"),J=!!a);return J};k.ajaxCrawlable(0);a.deparam=g=function(b,e){var d={},f={"true":!0,"false":!1,"null":null};a.each(b.replace(/\+/g," ").split("&"),function(b,n){var l=n.split("="),g=w(l[0]),k=d,h=0,m=g.split("]["),j=m.length-1;/\[/.test(m[0])&&/\]$/.test(m[j])?(m[j]=m[j].replace(/\]$/,""),m=m.shift().split("[").concat(m),j=m.length-1):j=0;if(2===l.length)if(l=w(l[1]),e&&(l=l&&!isNaN(l)?+l:"undefined"===l?c:f[l]!==c?f[l]:l),j)for(;h<=j;h++)g=""===m[h]?k.length:m[h],k=k[g]=h<j?k[g]||(m[h+1]&&
isNaN(m[h+1])?{}:[]):l;else a.isArray(d[g])?d[g].push(l):d[g]=d[g]!==c?[d[g],l]:l;else g&&(d[g]=e?c:"")});return d};g[y]=p(x,0);g[v]=A=p(x,1);a.elemUrlAttr||(a.elemUrlAttr=function(b){return a.extend(K,b)})({a:"href",base:"href",iframe:"src",img:"src",input:"src",form:"action",link:"href",script:"src"});H=a.elemUrlAttr;a.fn[y]=p(z,y);a.fn[v]=p(z,v);j.pushState=u=function(a,e){q(a)&&(/^#/.test(a)&&e===c)&&(e=2);var d=a!==c,d=k(location.href,d?a:{},d?e:2);location.href=d};j.getState=n=function(a,e){return a===
c||"boolean"===typeof a?A(a):A(e)[a]};j.removeState=function(b){var e={};b!==c&&(e=n(),a.each(a.isArray(b)?b:arguments,function(a,b){delete e[b]}));u(e,2)};I.hashchange=a.extend(I.hashchange,{add:function(b){function e(a){var b=a[v]=k();a.getState=function(a,d){return a===c||"boolean"===typeof a?g(b,a):g(b,d)[a]};d.apply(this,arguments)}var d;if(a.isFunction(b))return d=b,e;d=b.handler;b.handler=e}})})(jQuery,this);
(function(a,q,p){function s(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}"$:nomunge";var x=document,z,c=a.event.special,r=x.documentMode,w="onhashchange"in q&&(r===p||7<r);a.fn.hashchange=function(c){return c?a(this).bind("hashchange",c):a(this).trigger("hashchange")};a.fn.hashchange.delay=50;c.hashchange=a.extend(c.hashchange,{setup:function(){if(w)return!1;a(z.start)},teardown:function(){if(w)return!1;a(z.stop)}});var h=function(){var c=s(),j=A(k);c!==k?(g(k=c,j),a(q).trigger("hashchange")):
j!==k&&(location.href=location.href.replace(/#.*/,"")+j);t=setTimeout(h,a.fn.hashchange.delay)},c={},t,k=s(),g=r=function(a){return a},A=r;c.start=function(){t||h()};c.stop=function(){t&&clearTimeout(t);t=p};if((a.browser?a.browser.msie:a.support&&!1==a.support.leadingWhitespace)&&!w){var j,u;c.start=function(){j||(u=(u=a.fn.hashchange.src)&&u+s(),j=a('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){u||g(s());h()}).attr("src",u||"javascript:0").insertAfter("body")[0].contentWindow,
x.onpropertychange=function(){try{"title"===event.propertyName&&(j.document.title=x.title)}catch(a){}})};c.stop=r;A=function(){return s(j.location.href)};g=function(c,g){var h=j.document,k=a.fn.hashchange.domain;c!==g&&(h.title=x.title,h.open(),k&&h.write('<script>document.domain="'+k+'"\x3c/script>'),h.close(),j.location.hash=c)}}z=c})(jQuery,this);